<!DOCTYPE html>
<html lang="en">
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>User Profile</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/assets/css/FavoritePost.css">
    <link rel="stylesheet" href="/assets/css/home.css">


    <base href="/user/save-post">
    <link rel="stylesheet" href="/assets/css/FavoritePost.css">
    <link rel="stylesheet" href="/assets/css/home.css">


    <base href="/user/save-post">
</head>

<body ng-controller="FavoritesController">
    <h3>Bãi đỗ đã lưu</h3>
    <!-- Shimmer Effect for Loading -->
    <div ng-if="loading" class="text-center">
        <div class="card mb-3 post-item">
            <div class="shimmer-wrapper" style="height: auto;">
                <div class="row g-0">
                    <div class="col-md-4">
                        <div class="shimmer-block m-2" style="width: 100%; height: 250px; background: #e0e0e0;"></div>
                    </div>
                    <div class="col-md-8 d-flex flex-column">
                        <div class="card-title mb-0">
                            <div class="card-header bg-transparent border-0">
                                <div class="shimmer-block" style=" height: 50px;  background: #e0e0e0;">
                                </div>
                            </div>
                            <div class="card-body flex-grow-1">
                                <div class="shimmer-block mt-2" style="width: 90%; height: 20px; background: #e0e0e0;">
                                </div>
                                <div class="shimmer-block mt-2" style="width: 50%; height: 30px; background: #e0e0e0;">
                                </div>
                                <div class="shimmer-block mt-2" style="width: 90%; height: 20px; background: #e0e0e0;">
                                </div>
                            </div>
                            <div class="card-footer d-flex justify-content-between mt-auto bg-transparent border-0">
                                <div class="shimmer-block" style="width: 100%; height: 50px; background: #e0e0e0;">
                                </div>
                            </div>
                            <h3>Bãi đỗ đã lưu</h3>
                            <!-- Shimmer Effect for Loading -->
                            <div ng-if="loading" class="text-center">
                                <div class="card mb-3 post-item">
                                    <div class="shimmer-wrapper" style="height: auto;">
                                        <div class="row g-0">
                                            <div class="col-md-4">
                                                <div class="shimmer-block m-2"
                                                    style="width: 100%; height: 250px; background: #e0e0e0;"></div>
                                            </div>
                                            <div class="col-md-8 d-flex flex-column">
                                                <div class="card-title mb-0">
                                                    <div class="card-header bg-transparent border-0">
                                                        <div class="shimmer-block"
                                                            style=" height: 50px;  background: #e0e0e0;">
                                                        </div>
                                                    </div>
                                                    <div class="card-body flex-grow-1">
                                                        <div class="shimmer-block mt-2"
                                                            style="width: 90%; height: 20px; background: #e0e0e0;">
                                                        </div>
                                                        <div class="shimmer-block mt-2"
                                                            style="width: 50%; height: 30px; background: #e0e0e0;">
                                                        </div>
                                                        <div class="shimmer-block mt-2"
                                                            style="width: 90%; height: 20px; background: #e0e0e0;">
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="card-footer d-flex justify-content-between mt-auto bg-transparent border-0">
                                                        <div class="shimmer-block"
                                                            style="width: 100%; height: 50px; background: #e0e0e0;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="card mb-3 post-item">
                                    <div class="shimmer-wrapper" style="height: auto;">
                                        <div class="row g-0">
                                            <div class="col-md-4">
                                                <div class="shimmer-block m-2"
                                                    style="width: 100%; height: 250px; background: #e0e0e0;"></div>
                                            </div>
                                            <div class="col-md-8 d-flex flex-column">
                                                <div class="card-title mb-0">
                                                    <div class="card-header bg-transparent border-0">
                                                        <div class="shimmer-block"
                                                            style=" height: 50px;  background: #e0e0e0;">
                                                        </div>
                                                    </div>
                                                    <div class="card-body flex-grow-1">
                                                        <div class="shimmer-block mt-2"
                                                            style="width: 90%; height: 20px; background: #e0e0e0;">
                                                        </div>
                                                        <div class="shimmer-block mt-2"
                                                            style="width: 50%; height: 30px; background: #e0e0e0;">
                                                        </div>
                                                        <div class="shimmer-block mt-2"
                                                            style="width: 90%; height: 20px; background: #e0e0e0;">
                                                        </div>
                                                    </div>
                                                    <div
                                                        class="card-footer d-flex justify-content-between mt-auto bg-transparent border-0">
                                                        <div class="shimmer-block"
                                                            style="width: 100%; height: 50px; background: #e0e0e0;">
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card mb-3 post-item">
                                        <div class="shimmer-wrapper" style="height: auto;">
                                            <div class="row g-0">
                                                <div class="col-md-4">
                                                    <div class="shimmer-block m-2"
                                                        style="width: 100%; height: 250px; background: #e0e0e0;"></div>
                                                </div>
                                                <div class="col-md-8 d-flex flex-column">
                                                    <div class="card-title mb-0">
                                                        <div class="card-header bg-transparent border-0">
                                                            <div class="shimmer-block"
                                                                style=" height: 50px;  background: #e0e0e0;">
                                                            </div>
                                                        </div>
                                                        <div class="card-body flex-grow-1">
                                                            <div class="shimmer-block mt-2"
                                                                style="width: 90%; height: 20px; background: #e0e0e0;">
                                                            </div>
                                                            <div class="shimmer-block mt-2"
                                                                style="width: 50%; height: 30px; background: #e0e0e0;">
                                                            </div>
                                                            <div class="shimmer-block mt-2"
                                                                style="width: 90%; height: 20px; background: #e0e0e0;">
                                                            </div>
                                                        </div>
                                                        <div
                                                            class="card-footer d-flex justify-content-between mt-auto bg-transparent border-0">
                                                            <div class="shimmer-block"
                                                                style="width: 100%; height: 50px; background: #e0e0e0;">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>


                                <div ng-if="!loading && favorites.length === 0" class="text-center">
                                    Bạn chưa lưu bài đăng nào!
                                </div>

                                <div class="card mb-3 post-item" ng-repeat="favorite in favorites" ng-if="!loading">
                                    <a ng-href="/post-detail?id={{favorite.post}}"
                                        style="text-decoration: none; color: inherit;">
                                        <div class="row g-0">
                                            <div class="col-md-4">
                                                <div class="d-flex align-items-center justify-content-center"
                                                    style="height: 100%; background: #f8f9fa;">
                                                    <img ng-src="{{favorite.images[0].imageUrl}}"
                                                        class="img-fluid rounded-start" alt="Images" />
                                                </div>
                                            </div>
                                            <div class="col-md-8 d-flex flex-column">
                                                <div class="card-title mb-0">
                                                    <div class="card-header bg-transparent border-0">
                                                        <h4 class="font-weight-bold">{{favorite.parkingName}}</h4>
                                                    </div>
                                                    <div class="card-body flex-grow-1">
                                                        <h7 class="card-text district d-flex mb-2">
                                                            {{favorite.wardName}}, {{favorite.districtName}},
                                                            {{favorite.provinceName}}
                                                        </h7>
                                                        <h4 class="card-text text-danger">
                                                            {{formatCurrency(favorite.price) + " " +
                                                            favorite.priceUnit}}
                                                        </h4>
                                                        <span ng-repeat="vehicleType in favorite.vehicleTypes"
                                                            class="vehicle-type-inline">
                                                            {{vehicleType.vehicleTypeName}}
                                                            <span ng-if="!$last"> - </span>
                                                            <!-- Optional separator between items -->
                                                        </span>
                                                    </div>
                                                    <div class="card-footer d-flex justify-content-between mt-auto">
                                                        <p class="card-text username font-weight-bold mb-0">
                                                            Đăng bởi: {{favorite.user.username}}
                                                            <small
                                                                class="text-muted">{{formatTimeAgo(favorite.createdAt)}}</small>
                                                        </p>
                                                        <p class="card-text text-muted mb-0">
                                                            <i class="fa-regular fa-comment"></i>
                                                            {{favorite.commentCount}}
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                    <div class="d-flex justify-content-center mb-3 mt-3">
                                        <button class="btn btn-danger" ng-click="confirmUnfavorite(favorite)">
                                            <i class="fa fa-solid fa-bookmark"></i> Hủy lưu bài đăng
                                        </button>
                                    </div>


                                    <!-- Confirmation Modal -->
                                    <div class="modal fade" id="confirmationModal" tabindex="-1"
                                        aria-labelledby="confirmationModalLabel" aria-hidden="true">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="confirmationModalLabel">Xác nhận hủy
                                                    </h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"
                                                        aria-label="Close"></button>
                                                </div>
                                                <div class="modal-body">
                                                    Bạn có chắc chắn muốn hủy lưu bài đăng này không?
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary"
                                                        data-bs-dismiss="modal">Hủy</button>
                                                    <button type="button" class="btn btn-danger"
                                                        ng-click="toggleFavorite()">Xác
                                                        nhận</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Toast Notification -->
                                    <div aria-live="polite" aria-atomic="true" class="position-fixed bottom-0 end-0 p-3"
                                        style="z-index: 1100">

                                        <div id="toast" class="toast" role="alert" aria-live="assertive"
                                            aria-atomic="true">
                                            <div class="toast-header">
                                                <img src="https://res.cloudinary.com/dqzfuomvj/image/upload/v1730822083/1_au4rfg.jpg"
                                                    style="height:auto; width:50px" class="rounded me-2" alt="logo">
                                                <strong class="me-auto">Thông báo</strong>
                                                <!-- <small>11 mins ago</small> -->
                                                <button type="button" class="btn-close" data-bs-dismiss="toast"
                                                    aria-label="Close"></button>

                                                <!-- Toast Notification -->
                                                <div aria-live="polite" aria-atomic="true"
                                                    class="position-fixed bottom-0 end-0 p-3" style="z-index: 1100">

                                                    <div id="toast" class="toast" role="alert" aria-live="assertive"
                                                        aria-atomic="true">
                                                        <div class="toast-header">
                                                            <img src="https://res.cloudinary.com/dqzfuomvj/image/upload/v1730822083/1_au4rfg.jpg"
                                                                style="height:auto; width:50px" class="rounded me-2"
                                                                alt="logo">
                                                            <strong class="me-auto">Thông báo</strong>
                                                            <!-- <small>11 mins ago</small> -->
                                                            <button type="button" class="btn-close"
                                                                data-bs-dismiss="toast" aria-label="Close"></button>
                                                        </div>
                                                        <div class="toast-body">
                                                            {{ toastMessage }}
                                                            <div class="toast-body">
                                                                {{ toastMessage }}
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>

</body>

</html>